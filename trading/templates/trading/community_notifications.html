{% extends "base.html" %}
{% load i18n %}

{% block title %}{% bilingual "Notifications" "通知中心" %}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="d-flex align-items-center justify-content-between mb-4">
            <h1 class="h4 mb-0">{% bilingual "Notifications" "通知中心" %}</h1>
            <span class="text-muted small">
                {{ page_obj.paginator.count }}
                {% bilingual "updates" "条通知" %}
            </span>
        </div>
        {% if notifications %}
            <div class="list-group shadow-sm">
                {% for notice in notifications %}
                    <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-start notification-item{% if not notice.is_read %} notification-unread{% endif %}"
                       href="{% url 'trading:community' %}">
                        <div class="me-3">
                            <div class="fw-semibold">
                                {{ notice.actor.username }}
                                {% if notice.verb == "liked" %}
                                    {% bilingual "liked your post" "点赞了你的帖子" %}
                                {% elif notice.verb == "commented" %}
                                    {% bilingual "commented on your post" "评论了你的帖子" %}
                                {% else %}
                                    {% bilingual "interacted with your post" "与你的帖子互动" %}
                                {% endif %}
                            </div>
                            <div class="small text-muted">
                                {{ notice.target_post.title|default:notice.target_post.content|striptags|truncatechars:80 }}
                            </div>
                        </div>
                        <span class="small text-muted">{{ notice.created_at|date:"Y-m-d H:i" }}</span>
                    </a>
                {% endfor %}
            </div>
            {% if page_obj.has_other_pages %}
                <nav class="mt-3" aria-label="{% bilingual 'Notifications pagination' '通知翻页' %}">
                    <ul class="pagination pagination-sm justify-content-center mb-0">
                        <li class="page-item{% if not page_obj.has_previous %} disabled{% endif %}">
                            <a class="page-link" href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% else %}#{% endif %}" aria-label="{% bilingual 'Previous' '上一页' %}">
                                &laquo;
                            </a>
                        </li>
                        <li class="page-item active">
                            <span class="page-link">{{ page_obj.number }}</span>
                        </li>
                        <li class="page-item{% if not page_obj.has_next %} disabled{% endif %}">
                            <a class="page-link" href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% else %}#{% endif %}" aria-label="{% bilingual 'Next' '下一页' %}">
                                &raquo;
                            </a>
                        </li>
                    </ul>
                </nav>
            {% endif %}
        {% else %}
            <div class="alert alert-light border text-center py-4">
                {% bilingual "No notifications yet." "暂无通知。" %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
