{% extends "base.html" %}
{% load i18n static %}

{% block title %}{% bilingual "Notifications" "通知中心" %}{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'trading/css/community.css' %}?v={{ STATIC_VERSION|default:'20260211-community-v2-base' }}">
<link rel="stylesheet" href="{% static 'trading/css/community_hub_v2.css' %}?v={{ STATIC_VERSION|default:'20260211-community-v2' }}">
{% endblock %}

{% block content %}
<div class="community-notice-page container-xl">
    <section class="community-notice-shell">
        <header class="community-notice-head">
            <h1 class="community-notice-title">{% bilingual "Notifications" "通知中心" %}</h1>
            <span class="text-muted small">
                {{ page_obj.paginator.count }} {% bilingual "updates" "条通知" %}
            </span>
        </header>

        {% if notifications %}
            <div class="community-notice-list" data-role="notice-list">
                {% for notice in notifications %}
                    <a class="community-notice-item{% if not notice.is_read %} is-unread{% endif %}"
                       href="{% url 'trading:community' %}?post={{ notice.target_post.post_id }}#post-{{ notice.target_post.post_id }}">
                        <div class="community-notice-main">
                            <div class="title">
                                {{ notice.actor.username }}
                                {% if notice.verb == "liked" %}
                                    {% bilingual "liked your post" "点赞了你的帖子" %}
                                {% elif notice.verb == "commented" %}
                                    {% bilingual "commented on your post" "评论了你的帖子" %}
                                {% else %}
                                    {% bilingual "interacted with your post" "与你的帖子互动" %}
                                {% endif %}
                            </div>
                            <div class="summary">
                                {{ notice.target_post.title|default:notice.target_post.content|striptags|truncatechars:80 }}
                            </div>
                        </div>
                        <span class="community-notice-time">{{ notice.created_at|date:"Y-m-d H:i" }}</span>
                    </a>
                {% endfor %}
            </div>
            {% if page_obj.has_other_pages %}
                <nav class="mt-3" aria-label="{% bilingual 'Notifications pagination' '通知翻页' %}">
                    <ul class="pagination pagination-sm justify-content-center mb-0">
                        <li class="page-item{% if not page_obj.has_previous %} disabled{% endif %}">
                            <a class="page-link" href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% else %}#{% endif %}" aria-label="{% bilingual 'Previous' '上一页' %}">
                                &laquo;
                            </a>
                        </li>
                        <li class="page-item active">
                            <span class="page-link">{{ page_obj.number }}</span>
                        </li>
                        <li class="page-item{% if not page_obj.has_next %} disabled{% endif %}">
                            <a class="page-link" href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% else %}#{% endif %}" aria-label="{% bilingual 'Next' '下一页' %}">
                                &raquo;
                            </a>
                        </li>
                    </ul>
                </nav>
            {% endif %}
        {% else %}
            <div class="community-notice-empty">
                {% bilingual "No notifications yet." "暂无通知。" %}
            </div>
        {% endif %}
    </section>
</div>
{% endblock %}
