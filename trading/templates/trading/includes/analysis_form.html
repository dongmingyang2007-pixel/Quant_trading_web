{% load django_bootstrap5 i18n i18n_extras %}
<div class="card shadow-sm border-0 mb-4" id="analysis-form-card">
    <div class="card-body">
        {% with lang_prefix=request.LANGUAGE_CODE|default:'zh-hans'|lower|slice:":2" %}
        <div class="backtest-section-head mb-4">
            <h2 class="h4 mb-2">
                {% if lang_prefix == 'zh' %}æ——èˆ°ç­–ç•¥ä¸€é”®å›æµ‹{% else %}Flagship Strategy Â· One-click Backtest{% endif %}
            </h2>
            <p class="text-muted mb-0">
                {% if lang_prefix == 'zh' %}
                    ä»…éœ€è¾“å…¥æ ‡çš„ä¸æ—¶é—´åŒºé—´ï¼Œç³»ç»Ÿå°†ä»¥æ——èˆ°é‡åŒ–é…ç½®ã€AI æ´å¯Ÿä¸é«˜çº§é£é™©æ§åˆ¶è‡ªåŠ¨å®Œæˆå›æµ‹ã€‚
                {% else %}
                    Provide the ticker and horizon; the flagship config, AI insights, and risk stack will run automatically.
                {% endif %}
            </p>
        </div>
        {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {% for error in form.non_field_errors %}<div>{{ error }}</div>{% endfor %}
            </div>
        {% endif %}
        {% if warnings %}
            <div class="alert alert-warning">
                {% for warn in warnings %}<div>{{ warn }}</div>{% endfor %}
            </div>
        {% endif %}
        <form
            method="post"
            novalidate
            id="analysis-form"
            data-task-endpoint="{% url 'trading:api_v1_backtest_tasks' %}"
            data-task-status-template="{% url 'trading:api_v1_task_status' task_id='TASK_ID_PLACEHOLDER' %}"
            data-preflight-endpoint="{% url 'trading:api_v1_backtest_preflight' %}"
            data-robustness-endpoint="{% url 'trading:api_v1_backtest_robustness' %}"
            data-history-base="{% url 'trading:backtest' %}"
            data-lang="{{ request.LANGUAGE_CODE|default:'zh-hans' }}"
        >
            {% csrf_token %}
            <div class="row g-3">
                <div class="col-12 col-md-6">
                    <label class="form-label" for="{{ form.ticker.id_for_label }}">
                        {% if lang_prefix == 'zh' %}ä¸»è¦æ ‡çš„ä»£ç {% else %}Primary ticker{% endif %}
                    </label>
                    {{ form.ticker }}
                    <div class="form-text">
                        {% if lang_prefix == 'zh' %}
                            æ”¯æŒ Yahoo Finance ä»£ç ï¼Œä¾‹å¦‚ NVDAã€AAPLã€600519.SSã€‚
                        {% else %}
                            Accepts Yahoo Finance symbols, e.g., NVDA, AAPL, 600519.SS.
                        {% endif %}
                    </div>
                    {% if form.ticker.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.ticker.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="col-12 col-md-6">
                    <label class="form-label" for="{{ form.benchmark_ticker.id_for_label }}">
                        {% if lang_prefix == 'zh' %}å¯¹æ¯”åŸºå‡†ï¼ˆå¯é€‰ï¼‰{% else %}Benchmark (optional){% endif %}
                    </label>
                    {{ form.benchmark_ticker }}
                    <div class="form-text">
                        {% if lang_prefix == 'zh' %}
                            é»˜è®¤å¯¹æ¯” SPYï¼Œè‹¥ä¸“æ³¨å•ä¸€èµ„äº§å¯ç•™ç©ºã€‚
                        {% else %}
                            Defaults to SPY. Leave blank for single-asset focus.
                        {% endif %}
                    </div>
                    {% if form.benchmark_ticker.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.benchmark_ticker.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="col-12 col-md-6">
                    <label class="form-label" for="{{ form.start_date.id_for_label }}">
                        {% if lang_prefix == 'zh' %}å¼€å§‹æ—¥æœŸ{% else %}Start date{% endif %}
                    </label>
                    {{ form.start_date }}
                    {% if form.start_date.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.start_date.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="col-12 col-md-6">
                    <label class="form-label" for="{{ form.end_date.id_for_label }}">
                        {% if lang_prefix == 'zh' %}ç»“æŸæ—¥æœŸ{% else %}End date{% endif %}
                    </label>
                    {{ form.end_date }}
                    {% if form.end_date.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.end_date.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="col-12 col-md-6">
                    <label class="form-label" for="{{ form.capital.id_for_label }}">
                        {% if lang_prefix == 'zh' %}æ¨¡æ‹Ÿèµ„é‡‘è§„æ¨¡{% else %}Capital base{% endif %}
                    </label>
                    {{ form.capital }}
                    <div class="form-text">
                        {% if lang_prefix == 'zh' %}
                            ç”¨äºèµ„äº§é…ç½®å»ºæ¨¡ï¼Œé»˜è®¤ 250,000ã€‚
                        {% else %}
                            Used for allocation modeling. Default 250,000.
                        {% endif %}
                    </div>
                    {% if form.capital.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.capital.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
                        </div>
                    {% endif %}
                </div>
                <div class="col-12 col-md-6">
                    <label class="form-label" for="{{ form.ml_mode.id_for_label }}">
                        {% if lang_prefix == 'zh' %}æ¨¡å‹ç±»å‹{% else %}Model type{% endif %}
                    </label>
                    {{ form.ml_mode }}
                    <div class="form-text">
                        {% if lang_prefix == 'zh' %}
                            è½»é‡ GBDT å…¼å…·é€Ÿåº¦ä¸ç¨³å®šæ€§ï¼›æ·±åº¦æ¨¡å‹å¯æ•æ‰æ›´å¤šæ—¶åºæ¨¡å¼ï¼›Fusion ä¼šè‡ªåŠ¨èåˆ LSTM ä¸ Transformerã€‚
                        {% else %}
                            Light GBDT balances speed and stability; deep modes capture richer sequences. Fusion mixes LSTM with Transformer automatically.
                        {% endif %}
                    </div>
                    {% if form.ml_mode.errors %}
                        <div class="invalid-feedback d-block">
                            {% for error in form.ml_mode.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="border rounded-4 p-3 mt-4 backtest-presets"
                 data-role="preset-panel"
                 data-api-endpoint="{% url 'trading:api_v1_presets' %}"
                 data-detail-template="{% url 'trading:api_v1_preset_detail' preset_id='00000000-0000-0000-0000-000000000000' %}">
                <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
                    <div>
                        <h3 class="h6 mb-1">{% if lang_prefix == 'zh' %}ç­–ç•¥é¢„è®¾{% else %}Strategy presets{% endif %}</h3>
                        <p class="text-muted small mb-0">
                            {% if lang_prefix == 'zh' %}
                                ä¿å­˜å¸¸ç”¨å›æµ‹é…ç½®ï¼Œå¿«é€Ÿåº”ç”¨ä¸ç®¡ç†ã€‚
                            {% else %}
                                Save frequently used configs to apply or manage quickly.
                            {% endif %}
                        </p>
                    </div>
                </div>
                <div class="row g-3 mt-1">
                    <div class="col-12 col-md-6">
                        <label class="form-label">{% if lang_prefix == 'zh' %}é€‰æ‹©é¢„è®¾{% else %}Select preset{% endif %}</label>
                        <select class="form-select" data-role="preset-select">
                            <option value="">{% if lang_prefix == 'zh' %}è¯·é€‰æ‹©é¢„è®¾{% else %}Choose a preset{% endif %}</option>
                        </select>
                    </div>
                    <div class="col-12 col-md-6">
                        <label class="form-label">{% if lang_prefix == 'zh' %}é¢„è®¾åç§°{% else %}Preset name{% endif %}</label>
                        <input type="text"
                               class="form-control"
                               data-role="preset-name"
                               placeholder="{% if lang_prefix == 'zh' %}ä¾‹å¦‚ï¼šæ³¢åŠ¨ç‡ç¨³å¥ç­–ç•¥{% else %}e.g. Balanced Volatility{% endif %}">
                    </div>
                    <div class="col-12">
                        <label class="form-label">{% if lang_prefix == 'zh' %}é¢„è®¾æè¿°{% else %}Preset description{% endif %}</label>
                        <input type="text"
                               class="form-control"
                               data-role="preset-description"
                               placeholder="{% if lang_prefix == 'zh' %}æ·»åŠ ç®€çŸ­è¯´æ˜ï¼ˆå¯é€‰ï¼‰{% else %}Add a short note (optional){% endif %}">
                    </div>
                    <div class="col-12 d-flex flex-wrap align-items-center gap-2">
                        <button type="button" class="btn btn-outline-primary btn-sm" data-role="preset-apply">
                            {% if lang_prefix == 'zh' %}åº”ç”¨é¢„è®¾{% else %}Apply preset{% endif %}
                        </button>
                        <button type="button" class="btn btn-primary btn-sm" data-role="preset-save">
                            {% if lang_prefix == 'zh' %}ä¿å­˜é¢„è®¾{% else %}Save preset{% endif %}
                        </button>
                        <button type="button" class="btn btn-outline-secondary btn-sm" data-role="preset-toggle">
                            {% if lang_prefix == 'zh' %}ç®¡ç†é¢„è®¾{% else %}Manage presets{% endif %}
                        </button>
                        <div class="d-flex align-items-center gap-3 ms-auto">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="preset-include-dates" data-role="preset-include-dates">
                                <label class="form-check-label" for="preset-include-dates">
                                    {% if lang_prefix == 'zh' %}åŒ…å«æ ‡çš„/æ—¥æœŸ{% else %}Include ticker/dates{% endif %}
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="preset-default-flag" data-role="preset-default">
                                <label class="form-check-label" for="preset-default-flag">
                                    {% if lang_prefix == 'zh' %}è®¾ä¸ºé»˜è®¤{% else %}Set as default{% endif %}
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="alert alert-info d-none" data-role="preset-status"></div>
                    </div>
                </div>
                <div class="mt-3 d-none" data-role="preset-manage">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                        <strong>{% if lang_prefix == 'zh' %}é¢„è®¾åº“{% else %}Preset library{% endif %}</strong>
                        <button type="button" class="btn btn-link btn-sm text-decoration-none" data-role="preset-hide">
                            {% if lang_prefix == 'zh' %}æ”¶èµ·{% else %}Hide{% endif %}
                        </button>
                    </div>
                    <div class="list-group" data-role="preset-list"></div>
                </div>
            </div>
            <div class="accordion mt-4" id="advanced-settings">
                <div class="accordion-item border-0">
                    <h2 class="accordion-header" id="advanced-settings-heading">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#advanced-settings-panel" aria-expanded="false" aria-controls="advanced-settings-panel">
                            {% if lang_prefix == 'zh' %}é«˜çº§è®¾ç½®{% else %}Advanced settings{% endif %}
                        </button>
                    </h2>
                    <div id="advanced-settings-panel" class="accordion-collapse collapse" aria-labelledby="advanced-settings-heading" data-bs-parent="#advanced-settings">
                        <div class="accordion-body">
                            <div class="row g-3">
                                <div class="col-12 col-md-6">
                                    <label class="form-label" for="{{ form.strategy_engine.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}ç­–ç•¥å¼•æ“{% else %}Strategy engine{% endif %}
                                    </label>
                                    {{ form.strategy_engine }}
                                    <div class="form-text">
                                        {% if lang_prefix == 'zh' %}é€‰æ‹©æœ¬æ¬¡å›æµ‹çš„æ ¸å¿ƒç­–ç•¥å¼•æ“ã€‚{% else %}Pick the core engine for this run.{% endif %}
                                    </div>
                                </div>
                                <div class="col-12 col-md-6">
                                    <label class="form-label" for="{{ form.risk_profile.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}é£é™©åå¥½{% else %}Risk profile{% endif %}
                                    </label>
                                    {{ form.risk_profile }}
                                    <div class="form-text">
                                        {% if lang_prefix == 'zh' %}å†³å®šé£æ§ä¸ä»“ä½å°ºåº¦é£æ ¼ã€‚{% else %}Sets risk budget and sizing style.{% endif %}
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.short_window.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}çŸ­æœŸå‡çº¿çª—å£{% else %}Short window{% endif %}
                                    </label>
                                    {{ form.short_window }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.long_window.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}é•¿æœŸå‡çº¿çª—å£{% else %}Long window{% endif %}
                                    </label>
                                    {{ form.long_window }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.rsi_period.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}RSI å‘¨æœŸ{% else %}RSI period{% endif %}
                                    </label>
                                    {{ form.rsi_period }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.volatility_target.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}ç›®æ ‡æ³¢åŠ¨ç‡{% else %}Volatility target{% endif %}
                                    </label>
                                    {{ form.volatility_target }}
                                    <div class="form-text">{% if lang_prefix == 'zh' %}0-1 ä¹‹é—´ã€‚{% else %}Range 0-1.{% endif %}</div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.transaction_cost_bps.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}äº¤æ˜“æˆæœ¬ï¼ˆbpsï¼‰{% else %}Transaction cost (bps){% endif %}
                                    </label>
                                    {{ form.transaction_cost_bps }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.slippage_bps.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æ»‘ç‚¹ï¼ˆbpsï¼‰{% else %}Slippage (bps){% endif %}
                                    </label>
                                    {{ form.slippage_bps }}
                                </div>
                                <div class="col-12">
                                    <div class="text-muted small fw-semibold mt-2">{% if lang_prefix == 'zh' %}æ‰§è¡Œç°å®æ€§{% else %}Execution realism{% endif %}</div>
                                    <div class="text-muted small mb-0">
                                        {% if lang_prefix == 'zh' %}é…ç½®æˆäº¤å‚ä¸ç‡ã€æˆäº¤å£å¾„ä¸å†²å‡»æˆæœ¬ï¼Œå¸®åŠ©è¯„ä¼°çœŸå®å¯æ‰§è¡Œæ€§ã€‚{% else %}Configure fills, return path, and impact costs to reflect real-world execution.{% endif %}
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.return_path.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æ‰§è¡Œå£å¾„{% else %}Return path{% endif %}
                                    </label>
                                    {{ form.return_path }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.max_adv_participation.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}ADV å‚ä¸ç‡ä¸Šé™{% else %}Max ADV participation{% endif %}
                                    </label>
                                    {{ form.max_adv_participation }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.execution_liquidity_buffer.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æµåŠ¨æ€§ç¼“å†²{% else %}Liquidity buffer{% endif %}
                                    </label>
                                    {{ form.execution_liquidity_buffer }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.execution_penalty_bps.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æ‰§è¡Œå†²å‡»æƒ©ç½šï¼ˆbpsï¼‰{% else %}Execution penalty (bps){% endif %}
                                    </label>
                                    {{ form.execution_penalty_bps }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.limit_move_threshold.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æ¶¨è·Œå¹…é™åˆ¶é˜ˆå€¼{% else %}Limit move threshold{% endif %}
                                    </label>
                                    {{ form.limit_move_threshold }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.borrow_cost_bps.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}èåˆ¸æˆæœ¬ï¼ˆbpsï¼‰{% else %}Borrow cost (bps){% endif %}
                                    </label>
                                    {{ form.borrow_cost_bps }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.min_holding_days.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æœ€çŸ­æŒä»“å¤©æ•°{% else %}Min holding days{% endif %}
                                    </label>
                                    {{ form.min_holding_days }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.execution_delay_days.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æ‰§è¡Œå»¶è¿Ÿï¼ˆå¤©ï¼‰{% else %}Execution delay (days){% endif %}
                                    </label>
                                    {{ form.execution_delay_days }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.max_leverage.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æœ€å¤§æ æ†{% else %}Max leverage{% endif %}
                                    </label>
                                    {{ form.max_leverage }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.entry_threshold.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}å…¥åœºé˜ˆå€¼{% else %}Entry threshold{% endif %}
                                    </label>
                                    {{ form.entry_threshold }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.exit_threshold.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}ç¦»åœºé˜ˆå€¼{% else %}Exit threshold{% endif %}
                                    </label>
                                    {{ form.exit_threshold }}
                                </div>
                                <div class="col-12 col-md-4 d-flex align-items-end">
                                    <div class="form-check">
                                        {{ form.optimize_thresholds }}
                                        <label class="form-check-label" for="{{ form.optimize_thresholds.id_for_label }}">
                                            {% if lang_prefix == 'zh' %}ä¼˜åŒ–é˜ˆå€¼{% else %}Optimize thresholds{% endif %}
                                        </label>
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.train_window.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}è®­ç»ƒçª—å£{% else %}Train window{% endif %}
                                    </label>
                                    {{ form.train_window }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.test_window.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æµ‹è¯•çª—å£{% else %}Test window{% endif %}
                                    </label>
                                    {{ form.test_window }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.val_ratio.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}éªŒè¯é›†æ¯”ä¾‹{% else %}Validation ratio{% endif %}
                                    </label>
                                    {{ form.val_ratio }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.embargo_days.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}éš”ç¦»æœŸ{% else %}Embargo days{% endif %}
                                    </label>
                                    {{ form.embargo_days }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.max_drawdown_stop.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æœ€å¤§å›æ’¤æ­¢æŸ{% else %}Max drawdown stop{% endif %}
                                    </label>
                                    {{ form.max_drawdown_stop }}
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label" for="{{ form.daily_exposure_limit.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}æ—¥å†…æš´éœ²ä¸Šé™{% else %}Daily exposure limit{% endif %}
                                    </label>
                                    {{ form.daily_exposure_limit }}
                                </div>
                                <div class="col-12 col-md-6">
                                    <div class="form-check">
                                        {{ form.auto_apply_best_config }}
                                        <label class="form-check-label" for="{{ form.auto_apply_best_config.id_for_label }}">
                                            {% if lang_prefix == 'zh' %}è‡ªåŠ¨å¥—ç”¨æœ€ä¼˜é…ç½®{% else %}Auto-apply best config{% endif %}
                                        </label>
                                    </div>
                                    <div class="form-check mt-2">
                                        {{ form.enable_hyperopt }}
                                        <label class="form-check-label" for="{{ form.enable_hyperopt.id_for_label }}">
                                            {% if lang_prefix == 'zh' %}å¯ç”¨è¶…å‚æœç´¢{% else %}Enable hyperopt{% endif %}
                                        </label>
                                    </div>
                                    <div class="form-check mt-2">
                                        {{ form.allow_short }}
                                        <label class="form-check-label" for="{{ form.allow_short.id_for_label }}">
                                            {% if lang_prefix == 'zh' %}å…è®¸åšç©º{% else %}Allow short selling{% endif %}
                                        </label>
                                    </div>
                                </div>
                                <div class="col-12 col-md-6">
                                    <label class="form-label" for="{{ form.hyperopt_trials.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}è¶…å‚æœç´¢æ¬¡æ•°{% else %}Hyperopt trials{% endif %}
                                    </label>
                                    {{ form.hyperopt_trials }}
                                    <label class="form-label mt-3" for="{{ form.hyperopt_timeout.id_for_label }}">
                                        {% if lang_prefix == 'zh' %}è¶…å‚æœç´¢è¶…æ—¶ï¼ˆç§’ï¼‰{% else %}Hyperopt timeout (sec){% endif %}
                                    </label>
                                    {{ form.hyperopt_timeout }}
                                </div>
                            </div>
                            <div class="d-flex justify-content-end mt-3">
                                <button type="button" class="btn btn-outline-secondary btn-sm" data-role="advanced-reset">
                                    {% if lang_prefix == 'zh' %}æ¢å¤é»˜è®¤å€¼{% else %}Reset defaults{% endif %}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-end mt-4">
                <button type="submit" class="btn btn-primary btn-lg px-4">
                    <span class="me-1">ğŸ“Š</span>{% if lang_prefix == 'zh' %}ç”Ÿæˆé‡åŒ–æŠ¥å‘Š{% else %}Generate report{% endif %}
                </button>
            </div>
        </form>
        {{ advanced_defaults|json_script:"advanced-strategy-defaults" }}
        {% endwith %}
    </div>
</div>
